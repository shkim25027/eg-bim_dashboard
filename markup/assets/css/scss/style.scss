@charset "UTF-8";

@use "base" as *;
@forward "_root";
@forward "_layout";

// ============================================
// Layout Variables
// ============================================
$header-height: 80px;
$footer-height: 48px;
$grid-gap: 24px;
$card-gap: 16px;

// CSS Custom Properties (동적 계산)
:root {
  --header-height: #{$header-height};
  --footer-height: #{$footer-height};
  --grid-gap: #{$grid-gap};
  --total-offset: calc(var(--header-height) + var(--footer-height));
  --grid-height: calc((var(--window-inner-height) - var(--total-offset)) / 3);
}

// Grid height variants
$grid-heights: (
  "min": 320px,
  "default": var(--grid-height),
  "individual": calc((var(--grid-height) * 2) + $card-gap - 228px),
);

// ============================================
// Main Layout
// ============================================
.main {
  &-contents {
    display: grid;
    min-height: calc(var(--window-inner-height) - var(--header-height));
    grid-template-rows: repeat(3, 1fr);
    gap: $grid-gap;
  }

  &-grid {
    padding: 0 $grid-gap;
    display: grid;
    grid-template-columns: 418fr 335fr 247fr;
    grid-template-rows: repeat(2, 2fr);
    grid-row: 1 / 3;
    gap: $card-gap;
  }

  &-weekly {
    position: relative;
    padding: 0 $grid-gap;
    border-radius: 32px 32px 0 0;
    border-top: 4px solid #fff;
    background:
      linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.5) 0%,
        rgba(255, 255, 255, 0) 15%
      ),
      #f3efea;
    height: var(--grid-height);
    min-height: map-get($grid-heights, "min");
    box-shadow: 0 -4px 40px 0 rgba(0, 0, 0, 0.3);
    overflow: hidden;

    &::before {
      content: " ";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 276px;
      height: 134px;
      background: url(/assets/images/bg_weekly_logo.svg) no-repeat left bottom /
        cover;
    }
  }
}

// ============================================
// Card Components
// ============================================
.card {
  position: relative;
  border-radius: 8px;
  border: 2px solid var(--border-base);
  background: var(--bg-card);
  overflow: hidden;

  // Default card height
  &:not(.individual, .sales) {
    height: calc(var(--grid-height) + 4px);
  }

  // Double height cards
  &.individual,
  &.sales {
    $double-card-height: calc((var(--grid-height) * 2) + $grid-gap);
    height: $double-card-height;
    min-height: 656px;
    display: grid;
    grid-template-columns: 100%;
    grid-row: 1 / 3;
  }

  // Individual card
  &.individual {
    $individual-min: calc(650px - 228px);
    $individual-max: calc((var(--grid-height) * 2) + $card-gap - 228px);
    $individual-chart: clamp($individual-min, $individual-max, $individual-max);

    grid-column-start: 2;
    grid-template-rows: $individual-chart 228px;

    .chart-wrap {
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: 48px calc($individual-chart - 48px);
    }

    .card-body {
      height: 228px;
    }

    .label {
      font-size: 14px;
    }

    .stat-row {
      [class^="change"] {
        font-size: 10px;
        em {
          font-size: 16px;
        }
      }

      .big-num {
        font-size: 52px;
      }

      .unit {
        font-size: 12px;
      }
    }
  }

  // Sales card
  &.sales {
    $sales-base-height: 650px;
    $sales-header: 48px;
    $sales-stat: calc(($sales-base-height - $sales-header - $card-gap) / 6);
    $sales-min: calc(($sales-base-height - $sales-header - $sales-stat) / 2);
    $sales-max: calc(
      ((var(--grid-height) * 2) - $sales-header - $sales-stat) / 2
    );
    $sales-chart: clamp($sales-min, $sales-max, $sales-max);

    grid-column-start: 3;
    grid-template-rows: $sales-header 96fr 516fr;

    .card-body {
      @include flex();
    }

    .chart-wrap {
      position: relative;
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: repeat(2, $sales-chart);
      width: 100%;
      padding: 0 12px;
      height: calc($sales-max * 2);
      min-height: 510px;
      border-top: 1px solid var(--border-base);

      .legend {
        position: absolute;
        right: 24px;
        top: 6px;
        z-index: 1;
      }

      .chart-body {
        padding: 0;

        &:not(:last-child) {
          border-bottom: 1px dashed var(--border-base);
        }
      }
    }
  }

  // Card header
  &-header {
    position: relative;
    width: 100%;
    @include flex(center, space-between);

    h3 {
      position: relative;
      font-size: 22px;
      font-weight: 700;
      line-height: 1;
      height: 48px;
      padding: 12px 14px;
      color: var(--card-title);
      background: var(--bg-title);
      display: inline-flex;
      @include textStroke();

      &::after {
        content: "";
        position: absolute;
        top: 0;
        right: -48px;
        width: 48px;
        height: 48px;
        background: var(--bg-title);
        @include maskContents(url("/assets/images/mask_tail.svg"));
      }
    }

    .legend {
      padding-right: 12px;
    }
  }

  &-body {
    width: 100%;
  }

  // Yearly & Monthly cards
  &.yearly,
  &.month {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: 48px auto;
    min-height: map-get($grid-heights, "min");

    $yearly-min: 320px;
    $yearly-max: var(--grid-height);
    $yearly-chart: clamp($yearly-min, $yearly-max, $yearly-max);

    .chart {
      &-wrap {
        grid-column-start: 2;
        grid-row-start: 1;
        height: $yearly-chart;
        min-height: map-get($grid-heights, "min");
        padding: 12px;
        border-left: 1px solid var(--border-base);
      }

      &-body {
        height: calc($yearly-chart - 48px);
      }
    }

    .card-body {
      grid-column-start: 1;
      grid-row-start: 2;
      padding: 0 24px 12px;
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: repeat(3, 1fr);
    }
  }
}

// ============================================
// Stat Row Component
// ============================================
@mixin stat-style($color, $gradient) {
  .label {
    color: $color;
  }

  .big-num,
  .unit {
    font-weight: 700;
    background: $gradient;
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
}

.stat-row {
  padding: 12px 0;
  width: 100%;
  @include flex(center, space-between);

  &:not(:last-child) {
    border-bottom: 1px solid var(--border-stat);
  }

  &.accrue {
    @include stat-style(var(--stat-accrue), var(--stat-unit-accrue));
  }

  &.month {
    @include stat-style(var(--stat-month), var(--stat-unit-month));
  }

  &.individual01 {
    @include stat-style(
      var(--stat-individual01),
      var(--stat-unit-individual01)
    );
  }

  &.individual02 {
    @include stat-style(
      var(--stat-individual02),
      var(--stat-unit-individual02)
    );
  }

  &.sales {
    padding: 16px 24px;
    @include stat-style(var(--stat-sales), var(--stat-unit-sales));
  }

  .label-box {
    flex-direction: column;
    gap: 8px;
    @include flex(space-between, flex-start);
  }

  .label {
    font-size: 16px;
    font-weight: 700;
    line-height: 1;
    color: var(--change-label);
  }

  // Change indicators
  [class^="change"] {
    padding: 0 8px;
    height: 28px;
    border-radius: 50px;
    background: var(--bg-change-up);
    font-size: 12px;
    color: var(--change-base);
    gap: 4px;
    @include flex();

    em {
      position: relative;
      padding-left: 20px;
      font-size: 20px;
      font-weight: 700;
      line-height: 1.2;
      color: var(--text-base);

      &::before {
        content: " ";
        position: absolute;
        left: 6px;
        top: calc(50% - 1px);
        width: 8px;
        height: 2px;
        background: var(--text-base);
      }
    }

    &[class*="down"] {
      background: var(--bg-change-down);

      em {
        color: var(--change-down);

        &::before {
          left: 4px;
          top: calc(50% - 5px);
          width: 0;
          height: 0;
          background: none;
          border-style: solid;
          border-width: 10px 6px 0 6px;
          border-color: var(--change-down) transparent transparent transparent;
        }
      }
    }

    &[class*="up"] {
      em {
        color: var(--change-up);

        &::before {
          left: 4px;
          top: calc(50% - 5px);
          width: 0;
          height: 0;
          background: none;
          border-style: solid;
          border-width: 0 6px 10px 6px;
          border-color: transparent transparent var(--change-up) transparent;
        }
      }
    }
  }

  .big-num {
    font-size: rem(68px);
    line-height: 1;
  }

  .unit {
    font-size: 18px;
  }

  .big-num,
  .unit {
    font-weight: 700;
    background: var(--stat-unit-base);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
}

// ============================================
// Chart Component
// ============================================
.chart {
  &-wrap {
    background: var(--bg-chart);
    width: 100%;
    height: 100%;
  }

  &-header {
    width: 100%;
    font-size: 14px;
    @include flex(center, space-between);
  }

  &-body {
    position: relative;
    flex-grow: 1;
    width: 100%;
    padding: 12px;

    .badge-box {
      position: absolute;
      top: 12px;
      left: 12px;
    }
  }
}

// ============================================
// Badge Component
// ============================================
@mixin badge-style($border-color, $bg-color, $text-color) {
  border-color: $border-color;
  background: $bg-color;
  color: $text-color;
}

[class^="badge"] {
  &:not([class*="box"]) {
    display: inline-block;
    padding: 4px;
    border-radius: 2px;
    border-width: 1px;
    border-style: solid;
    font-weight: 700;
    line-height: 1;
  }

  &[class*="box"] {
    gap: 8px;
    @include flex();
  }

  &[class*="year"] {
    @include badge-style(
      var(--stat-accrue),
      var(--bg-badge-mixline),
      var(--stat-accrue)
    );
  }

  &[class*="month"] {
    @include badge-style(
      var(--stat-month),
      var(--bg-badge-month),
      var(--stat-month)
    );
  }

  &[class*="individual01"] {
    @include badge-style(
      var(--stat-individual01),
      var(--bg-badge-linearea01),
      var(--stat-individual01)
    );
  }

  &[class*="individual02"] {
    @include badge-style(
      var(---stat-individual02),
      var(--bg-badge-linearea02),
      var(--stat-individual02)
    );
  }
}

// ============================================
// Legend Component
// ============================================
.legend {
  gap: 8px;
  font-size: 14px;
  color: var(--text-secondary);
  @include flex();

  &-dot {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 2px;
    margin-right: 2px;

    &.mix-bar {
      background: var(--bg-chart-mixbar);
    }

    &.mix-line {
      background: var(--chart-mixline);
    }

    &.line-area01 {
      background-color: var(--bg-chart-linearea01);
    }

    &.line-area02 {
      background-color: var(--bg-chart-linearea02);
    }
  }
}

// ============================================
// Individual Component
// ============================================
@mixin person-name-style($bg-color, $gradient) {
  background-color: $bg-color;

  span,
  small {
    background: $gradient;
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
}

.individual {
  .card-body {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    padding: 24px 0 12px;

    .person-box {
      padding: 0 24px;
    }
  }

  .person {
    &-box {
      position: relative;

      &:nth-child(1) {
        &:not(:last-child) {
          &::after {
            content: "";
            position: absolute;
            right: 0;
            top: 0;
            height: calc(100% - 16px);
            border-right: 2px solid var(--border-person);
          }
        }

        .person-name {
          @include person-name-style(
            var(--bg-individual01),
            var(--stat-unit-individual01)
          );
        }
      }

      &:nth-child(2) {
        .person-name {
          @include person-name-style(
            var(--bg-individual02),
            var(--stat-unit-individual02)
          );
        }
      }
    }

    &-name {
      text-align: center;
      height: 42px;
      width: 100%;
      border-radius: 8px;
      font-size: 22px;
      font-weight: 700;
      gap: 4px;
      @include flex();

      small {
        padding-top: 4px;
        font-size: 16px;
      }
    }
  }
}

// ============================================
// Weekly Component
// ============================================
.weekly {
  &-grid {
    position: relative;
    display: grid;
    grid-template-columns: 267px auto;
    height: 100%;
    overflow: hidden;
    z-index: 1;
  }

  &-header {
    flex-direction: column;
    @include flex(flex-start, space-around);
  }

  &-title {
    color: var(--text-weekly-title);
    font-size: 36px;
    font-weight: 700;

    h3 {
      font: inherit;
    }
  }

  .person {
    &-list {
      gap: 12px;
      flex-direction: column;
      @include flex();

      .name {
        font-size: rem(16px);
        font-weight: 500;

        small {
          font-size: rem(12px);
          font-weight: 500;
        }
      }

      li {
        gap: 6px;
        @include flex();
      }
    }
  }

  [class^="badge"] {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: rem(18px);
    height: rem(18px);
    font-size: rem(12px);
    color: #fff;
    border: none;
    line-height: rem(18px);
    padding: 0;
  }

  .badge {
    &-green {
      background: linear-gradient(180deg, #2b8f10 0%, #1b580b 100%);
    }

    &-purple {
      background: linear-gradient(180deg, #7c108f 0%, #41074c 100%);
    }

    &-teal {
      background: linear-gradient(180deg, #00d8e7 0%, #004e53 100%);
    }
  }

  .schedule {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    height: var(--grid-height);
    min-height: map-get($grid-heights, "min");
  }

  .day {
    &-card {
      padding-top: 16px;
      color: #555;

      &:not(:last-child) {
        border-right: 1px solid var(--border-base);
      }

      &.today {
        background: rgba(255, 92, 0, 0.25);
        color: #000;
      }
    }

    &-title {
      position: relative;
      padding: 0 8px;
      height: 48px;
      font-weight: 700;
      @include flex();

      span {
        font-weight: 400;
      }

      &::after {
        content: " ";
        position: absolute;
        bottom: 0;
        left: 8px;
        width: calc(100% - 16px);
        height: 1px;
        background: var(--border-base);
      }
    }

    &-list {
      padding: 16px 8px;
      height: calc(var(--grid-height) - 70px);
      min-height: calc(#{map-get($grid-heights, "min")} - 70px);
      overflow: auto;

      li {
        position: relative;
        padding-left: rem(24px);
        word-break: keep-all;

        &:not(:last-child) {
          margin-bottom: 8px;
        }

        &::before {
          content: " ";
          position: absolute;
          left: 10px;
          top: rem(10px);
          display: inline-block;
          width: 4px;
          height: 4px;
          background-color: #555;
          border-radius: 50%;
        }
      }

      .active {
        font-weight: 500;
      }
    }
  }
}

// ============================================
// Sales Component
// ============================================
.sales {
  .person {
    &-list {
      align-self: flex-end;
      flex-direction: column;
      gap: 4px;
      @include flex();

      dl {
        border-radius: 4px;
        overflow: hidden;
        @include flex(center, space-between);

        dt {
          width: 24px;
          height: 24px;
          color: #fff;
          font-size: 12px;
          @include flex();
        }

        dd {
          width: 58px;
          text-align: right;
          padding: 0 8px;
          font-weight: bold;

          small {
            font-size: 10px;
          }
        }
      }

      .individual01 {
        background-color: var(--bg-individual01);

        dt {
          background: var(--stat-unit-individual01);
        }

        dd {
          color: var(--stat-individual01);
        }
      }

      .individual02 {
        background-color: var(--bg-individual02);

        dt {
          background: var(--stat-unit-individual02);
        }

        dd {
          color: var(--stat-individual02);
        }
      }
    }
  }
}

// ============================================
// calendar Component
// ============================================

.calendar {
  &.modal {
    display: flex;
    align-items: flex-end;
    padding: 0;
  }
  .modal {
    &-content {
      max-width: 100%;
      border-radius: 32px 32px 0 0;
      border-top: 3px solid #fff;
      background: var(--bg-calendar);
      box-shadow: 0 -3px 30px 0 rgba(0, 0, 0, 0.8);
      overflow: hidden;
    }
    &-header {
      padding: 0 24px;
      height: 80px;
    }
    &-body {
      height: calc(var(--window-inner-height) - 160px);
    }
  }
  .filter-options {
    gap: 6px;
    @include flex();
    .checkbox-group {
      border-radius: 4px;
      padding: 8px 12px;
      border: 1px solid rgba(0, 0, 0, 0.15);
      font-size: 16px;
      font-weight: 500;
      gap: 8px;
      @include flex();
      &.green {
        background: rgba(43, 143, 16, 0.05);
        input[type="checkbox"]:checked {
          border-color: #257a0e;
          background-color: #2b8f10;
        }
      }
      &.purple {
        background: rgba(124, 16, 143, 0.05);
        input[type="checkbox"]:checked {
          border-color: #6a0e7a;
          background-color: #7c108f;
        }
      }
      &.teal {
        background: rgba(4, 164, 175, 0.05);
        input[type="checkbox"]:checked {
          border-color: #008b94;
          background-color: #00a3ae;
        }
      }
      input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 4px;
        border: 1.5px solid rgba(0, 0, 0, 0.15);
        background-color: #fff;
        &:checked {
          background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10' fill='none'%3E%3Cpath d='M3.67169 10C3.33979 10 3.03554 9.84159 2.84193 9.60398L0.186696 6.19818C0.10372 6.09258 0.0484027 5.98697 0.020744 5.85496C-0.00691467 5.72296 -0.00691467 5.59095 0.020744 5.45894C0.020744 5.32693 0.0760614 5.19493 0.159037 5.08932C0.242014 4.98371 0.32499 4.87811 0.435624 4.7989C0.546259 4.7197 0.656894 4.6669 0.795187 4.6405C0.933481 4.61409 1.07177 4.58769 1.21007 4.6405C1.34836 4.6405 1.48665 4.6933 1.59729 4.7725C1.70792 4.85171 1.81856 4.93091 1.90153 5.03652L3.64403 7.28064L8.06942 0.46906C8.20772 0.257848 8.45664 0.0994388 8.73323 0.0202343C9.00982 -0.0325687 9.28641 0.0202343 9.50768 0.152242C10.0055 0.442658 10.1438 1.04989 9.83958 1.52512L4.58443 9.52477C4.50145 9.65678 4.36316 9.78879 4.22486 9.86799C4.08657 9.9472 3.92062 10 3.75467 10C3.75467 10 3.72701 10 3.69935 10H3.67169Z' fill='white'/%3E%3C/svg%3E%0A");
          background-position: center;
          background-repeat: no-repeat;
          background-size: 10px;
        }
      }
    }
  }
  .date-navigation {
    gap: 24px;
    @include flex();
    .nav-btn {
      width: 32px;
      height: 32px;
      padding: 8px 12px;
      gap: 8px;
      border-radius: 50px;
      border: 1px solid rgba(0, 0, 0, 0.4);
      background: linear-gradient(180deg, #f0f0f0 0%, #e1e0de 100%);
      box-shadow: 0 1px 2px 1px rgba(0, 0, 0, 0.2);
      @include flex();
    }
  }
  .current-date {
    position: relative;
    font-size: 40px;
    font-weight: 700;
    background: linear-gradient(180deg, #777 0%, #000 100%);
    @include textClip();
    &:before {
      content: attr(data-text);
      position: absolute;
      inset: 0;
      pointer-events: none;
      color: transparent;
      z-index: -1;
      @include textStroke(rgba(255, 255, 255));
    }
  }
  .flex {
    gap: 38px;
    padding-right: 16px;
  }
  .weekdays {
    display: grid;
    grid-template-columns: minmax(100px, 5.2083%) repeat(5, 1fr) minmax(
        100px,
        5.2083%
      );
    height: 32px;
    background:
      linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.2) 0%,
        rgba(255, 255, 255, 0) 100%
      ),
      #895d24;
    border: 2px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 -8px 16px 0 rgba(0, 0, 0, 0.2) inset;
    font-size: 16px;
    font-weight: 700;
    text-align: center;
    color: #fff;
    @include textStroke();
    .weekday {
      &:not(:last-child) {
        border-right: 0.5px solid rgba(0, 0, 0, 0.2);
      }
    }
  }
  .calendar-days {
    height: calc(var(--window-inner-height) - 160px);
    overflow-y: auto;
  }
  .days {
    display: grid;
    grid-template-columns: minmax(100px, 5.2083%) repeat(5, 1fr) minmax(
        100px,
        5.2083%
      );
    height: 100%;
    &.collapsed {
      grid-auto-rows: 1fr;
      max-height: none;
      overflow-y: visible;
      .day {
        min-height: 0;
        height: 100%;
        overflow: hidden;
        &:not(.current-week) {
          overflow: hidden;
        }
      }
    }
    .day {
      padding: 8px 8px 16px 8px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      color: var(--text-primary);
      &.other-month {
        //color: rgba(0, 0, 0, 0.5);
        opacity: 0.5;
      }
      &.current-week {
        position: relative;
        height: auto;
        background: #fff;
        &:nth-last-of-type(1) {
          &::before {
            content: " ";
            position: absolute;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100%;
            box-shadow: 0 0 32px 0 rgba(0, 0, 0, 0.15);
          }
        }
      }
      &:not(:nth-child(7n + 1)) {
        border-left: 1px solid rgba(0, 0, 0, 0.1);
      }
      &:nth-child(7n) {
        background: rgba(0, 107, 188, 0.03);
        .day-number {
          color: #006bbc;
        }
      }
      &:nth-child(7n + 1) {
        background: rgba(188, 0, 0, 0.03);
        .day-number {
          color: #bc0000;
        }
      }
      &.today {
        color: var(--text-base);
        font-weight: 500;
        background: rgba(255, 92, 0, 0.25);
      }
      &-content {
        gap: 8px;
        flex-direction: column;
        @include flex(flex-start, center);
      }
      &-number {
        font-size: 18px;
        color: var(--text-primary);
      }
    }
  }
  .event {
    &-item {
      gap: 4px;
      //  flex-wrap: nowrap;
      // @include flex(flex-start, center);
    }
    &-title {
      em {
        color: #f00;
      }
    }
    &-tag {
      width: 20px;
      height: 20px;
      font-size: 14px;
      font-weight: 700;
      border-radius: 2px;
      color: #fff;
      margin: 0 2px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
  }
}
